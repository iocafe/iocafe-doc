
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Step 2: Building References &amp; API docs &#8212; iocafe 0.1 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Step 1: Getting started with RST" href="step-1.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="step-2-building-references-api-docs">
<h1>Step 2: Building References &amp; API docs<a class="headerlink" href="#step-2-building-references-api-docs" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Finish at 11:15</p>
</div>
<div class="section" id="concepts">
<h2>Concepts<a class="headerlink" href="#concepts" title="Permalink to this headline">¶</a></h2>
<div class="section" id="referencing">
<h3>Referencing<a class="headerlink" href="#referencing" title="Permalink to this headline">¶</a></h3>
<p>Another important Sphinx feature is that it allows referencing across documents.
This is another powerful way to tie documents together.</p>
<p>The simplest way to do this is to define an explicit reference object:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span class="p">..</span> <span class="nt">_reference-name:</span>

<span class="gh">Cool section</span>
<span class="gh">------------</span>
</pre></div>
</div>
<p>Which can then be referenced with <code class="docutils literal notranslate"><span class="pre">:ref:</span></code>:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span class="na">:ref:</span><span class="nv">`reference-name`</span>
</pre></div>
</div>
<p>Which will then be rendered with the title of the section <em>Cool section</em>.</p>
<p>Sphinx also supports <code class="docutils literal notranslate"><span class="pre">:doc:`docname`</span></code> for linking to a document.</p>
</div>
<div class="section" id="semantic-descriptions-and-references">
<h3>Semantic Descriptions and References<a class="headerlink" href="#semantic-descriptions-and-references" title="Permalink to this headline">¶</a></h3>
<p>Sphinx also has much more powerful semantic referencing capabilities,
which knows all about software development concepts.</p>
<p>Say you’re creating a CLI application.
You can define an option for that program quite easily:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span class="p">..</span> <span class="ow">option</span><span class="p">::</span> -i &lt;regex&gt;, --ignore &lt;regex&gt;

   Ignore pages that match a specific pattern.
</pre></div>
</div>
<p>That can also be referenced quite simply:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span class="na">:option:</span><span class="nv">`-i`</span>
</pre></div>
</div>
<p>Sphinx includes a large number of these semantic types, including:</p>
<ul class="simple">
<li><code class="xref rst rst-dir docutils literal notranslate"><span class="pre">Module</span></code></li>
<li><code class="xref rst rst-dir docutils literal notranslate"><span class="pre">Class</span></code></li>
<li><code class="xref rst rst-dir docutils literal notranslate"><span class="pre">Method</span></code></li>
</ul>
</div>
<div class="section" id="external-references">
<h3>External References<a class="headerlink" href="#external-references" title="Permalink to this headline">¶</a></h3>
<p>Sphinx also includes a number of pre-defined references for external concepts.
Things like PEP’s and RFC’s:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre>You can learn more about this at <span class="na">:pep:</span><span class="nv">`8`</span> or <span class="na">:rfc:</span><span class="nv">`1984`</span>.
</pre></div>
</div>
<p>You can read more about this in the Sphinx <span class="xref std std-ref">inline-markup</span> docs.</p>
</div>
<div class="section" id="automatically-generating-this-markup">
<h3>Automatically generating this markup<a class="headerlink" href="#automatically-generating-this-markup" title="Permalink to this headline">¶</a></h3>
<p>Of course, Sphinx wants to make your life easy.
It includes ways to automatically create these object definitions for your own code.
This is called <code class="docutils literal notranslate"><span class="pre">audodoc</span></code>,
which allows you do to syntax like this:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span class="p">..</span> <span class="ow">automodule</span><span class="p">::</span> crawler
</pre></div>
</div>
<p>and have it document the full Python module importable as <code class="docutils literal notranslate"><span class="pre">crawler</span></code>.
You can also do a full range of auto functions:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span class="p">..</span> <span class="ow">autoclass</span><span class="p">::</span>
<span class="p">..</span> <span class="ow">autofunction</span><span class="p">::</span>
<span class="p">..</span> <span class="ow">autoexception</span><span class="p">::</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The module must be importable by Sphinx when running.
We’ll cover how to do this in the Tasks below.</p>
</div>
<p>You can read more about this in the Sphinx <code class="xref py py-mod docutils literal notranslate"><span class="pre">autodoc</span></code> docs.</p>
</div>
</div>
<div class="section" id="tasks">
<h2>Tasks<a class="headerlink" href="#tasks" title="Permalink to this headline">¶</a></h2>
<div class="section" id="referencing-code">
<h3>Referencing Code<a class="headerlink" href="#referencing-code" title="Permalink to this headline">¶</a></h3>
<p>Let’s go ahead and add a cookbook to our documentation.
Users will often come to your project to solve the same problems.
Including a Cookbook or Examples section will be a great resource for this content.</p>
<p>In your <code class="docutils literal notranslate"><span class="pre">cookbook.rst</span></code>,
add the following:</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Live Preview: <span class="xref std std-doc">crawler/docs/step2/cookbook</span></p>
</div>
<p>Remember, you will need to use <code class="docutils literal notranslate"><span class="pre">:option:</span></code> blocks here.
This is because they are referencing a command line option for our program.</p>
</div>
<div class="section" id="adding-reference-targets">
<h3>Adding Reference Targets<a class="headerlink" href="#adding-reference-targets" title="Permalink to this headline">¶</a></h3>
<p>Now that we have pointed at our CLI options,
we need to actually define them.
In your <code class="docutils literal notranslate"><span class="pre">cli.rst</span></code> file,
add the following:</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Live Preview: <span class="xref std std-doc">crawler/docs/step2/cli</span></p>
</div>
<p>Here you are documenting the actual options your code takes.</p>
<div class="section" id="try-it-out">
<h4>Try it out<a class="headerlink" href="#try-it-out" title="Permalink to this headline">¶</a></h4>
<p>Let’s go ahead and build the docs and see what happens.
Do a:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="n">make</span> <span class="n">html</span>
</pre></div>
</div>
<p>Here you will see that the <code class="docutils literal notranslate"><span class="pre">:option:</span></code> blocks magically become links to the definition.
This is your first taste of Semantic Markup.
With Sphinx,
we are able to simply say that something is a <code class="docutils literal notranslate"><span class="pre">option</span></code>,
and then it handles everything for us;
linking between the definition and the usage.</p>
</div>
</div>
<div class="section" id="importing-code">
<h3>Importing Code<a class="headerlink" href="#importing-code" title="Permalink to this headline">¶</a></h3>
<p>Being able to define options and link to them is pretty neat.
Wouldn’t it be great if we could do that with actual code too?
Sphinx makes this easy,
let’s take a look.</p>
<p>We’ll go ahead and create an <code class="docutils literal notranslate"><span class="pre">api.rst</span></code> that will hold our API reference:</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Live Preview: <span class="xref std std-doc">crawler/docs/step2/api</span></p>
</div>
<p>Remember, you’ll need to use the  <code class="docutils literal notranslate"><span class="pre">..</span> <span class="pre">autoclass::</span></code> directive to pull in your source code.
This will render the docstrings of your Python code nicely.</p>
</div>
<div class="section" id="requirements">
<h3>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h3>
<p>In order to build your code,
it needs to be able to import it.
This means it needs all of the required Python modules you import in the code.</p>
<p>If you have third party dependencies,
that means that you have to have them installed in your Python environment.
Luckily,
for most cases you can actually mock these variables using <a class="reference external" href="http://www.sphinx-doc.org/en/stable/ext/autodoc.html#confval-autodoc_mock_imports">autodoc_mock_imports</a>.</p>
<p>In your <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> go ahead and add:</p>
<blockquote>
<div>autodoc_mock_imports = [‘bs4’, ‘requests’]</div></blockquote>
<p>This will allow your docs to import the example code without requiring those modules be installed.</p>
</div>
<div class="section" id="tell-sphinx-about-your-code">
<h3>Tell Sphinx about your code<a class="headerlink" href="#tell-sphinx-about-your-code" title="Permalink to this headline">¶</a></h3>
<p>When Sphinx runs autodoc,
it imports your Python code to pull off the docstrings.
This means that Sphinx has to be able to see your code.
We’ll need to add our <code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code> to our <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> so it can import the code.</p>
<p>If you open up your <code class="docutils literal notranslate"><span class="pre">conf.py</span></code> file,
you should see something close to this on line 18:</p>
<p>As it notes,
you need to let it know the path to your Python source.
In our example it will be <code class="docutils literal notranslate"><span class="pre">../src/</span></code>,
so go ahead and put that in this setting.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You should always use relative paths here.
Part of the value of Sphinx is having your docs build on other people’s computers,
and if you hard code local paths that won’t work!</p>
</div>
<div class="section" id="id1">
<h4>Try it out<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>Now go ahead and regenerate your docs and look at the magic that happened:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="n">make</span> <span class="n">html</span>
</pre></div>
</div>
<p>Your Python docstrings have been magically imported into the project.</p>
</div>
</div>
<div class="section" id="tie-it-all-together">
<h3>Tie it all together<a class="headerlink" href="#tie-it-all-together" title="Permalink to this headline">¶</a></h3>
<p>Now let’s link directly to that for users who come in to the project.
Update your <code class="docutils literal notranslate"><span class="pre">index.rst</span></code> to look like:</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Live Preview: <span class="xref std std-doc">crawler/docs/step2/index</span></p>
</div>
<p>One last time,
let’s rebuild those docs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="n">make</span> <span class="n">html</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">You now have awesome documentation! :)</p>
</div>
<p>Now you have a beautiful documentation reference that is coming directly from your code.
This means that every time you change your code,
it will automatically be reflected in your documentation.</p>
<p>The beauty of this approach is that it allows you to keep your prose and reference documentation in the same place.
It even lets you semantically reference the code from inside the docs.
This is amazingly powerful and a great way to write documentation.</p>
</div>
</div>
<div class="section" id="extra-credit">
<h2>Extra Credit<a class="headerlink" href="#extra-credit" title="Permalink to this headline">¶</a></h2>
<p>Have some extra time left?
Let’s look through the code to understand what’s happening here more.</p>
<div class="section" id="look-through-intersphinx">
<h3>Look through intersphinx<a class="headerlink" href="#look-through-intersphinx" title="Permalink to this headline">¶</a></h3>
<p>Intersphinx allows you to bring the power of Sphinx references to multiple projects.
It lets you pull in references,
and semantically link them across projects.
For example,
in this guide we reference the Sphinx docs a lot,
so we have this intersphinx setting:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="n">intersphinx_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;sphinx&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;http://sphinx-doc.org/&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Which allows us to add a prefix to references and have them resolve:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span class="na">:ref:</span><span class="nv">`sphinx:inline-markup`</span>
</pre></div>
</div>
<p>We can also ignore the prefix,
and Sphinx will fall back to intersphinx references if none exist in the current project:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span class="na">:ref:</span><span class="nv">`inline-markup`</span>
</pre></div>
</div>
<p>You can read more about this in the <code class="xref py py-mod docutils literal notranslate"><span class="pre">intersphinx</span></code> docs.</p>
</div>
<div class="section" id="understand-the-code">
<h3>Understand the code<a class="headerlink" href="#understand-the-code" title="Permalink to this headline">¶</a></h3>
<p>A lot of the magic that is happening in <a class="reference internal" href="#importing-code">Importing Code</a> above is actually in the source code.</p>
<p>Check out the code for <code class="docutils literal notranslate"><span class="pre">crawler/main.py</span></code>:</p>
<p>As you can see,
we’re heavily using RST in our docstrings.
This gives us the same power as we have in Sphinx,
but allows it to live within the code base.</p>
<p>This approach of having the docs live inside the code is great for some things.
However,
the power of Sphinx allows you to mix docstrings and prose documentation together.
This lets you keep the amount of</p>
</div>
<div class="section" id="moving-on">
<h3>Moving on<a class="headerlink" href="#moving-on" title="Permalink to this headline">¶</a></h3>
<p>Could it get better?
In fact,
it can and it will.
Let’s go on to <span class="xref std std-doc">step-3</span>.</p>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">iocafe</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="step-1.html">Step 1: Getting started with RST</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Step 2: Building References &amp; API docs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#concepts">Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tasks">Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#extra-credit">Extra Credit</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="step-1.html" title="previous chapter">Step 1: Getting started with RST</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Pekka Lehtikoski, Markku Nissinen.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/introduction/step-2.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>